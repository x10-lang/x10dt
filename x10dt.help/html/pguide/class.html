<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
           "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 3.89">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
 
      
<title>What's In A Class</title>

 <h2><a name="tth_sEc2">
2</a>&nbsp;&nbsp;What's In A Class?</h2>

<div class="p"><!----></div>
The best way to see what's in a class is an example that says it all.  <tt>NoahsArk</tt>
in Figure  is it.

<div class="p"><!----></div>
<a name="tth_fIg1">
</a> <a name="fig:nark">
</a><hr />

<pre>&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;NoahsArk&nbsp;{
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;DEFAULT_SIZE&nbsp;=&nbsp;500;
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;val&nbsp;name:&nbsp;String;
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;var&nbsp;passengers:&nbsp;Array[String](1);
&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;var&nbsp;onBoard:&nbsp;Int&nbsp;=&nbsp;0;
&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;def&nbsp;this(name:&nbsp;String)&nbsp;{
&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(name,&nbsp;DEFAULT_SIZE});
&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;def&nbsp;this(name:String,&nbsp;initialCapacity:Int)&nbsp;{
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;name;&nbsp;&nbsp;
11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passengers&nbsp;=&nbsp;new&nbsp;Array[String][1..initialCapacity);
12&nbsp;&nbsp;&nbsp;&nbsp;}
13&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;def&nbsp;resize(size:Int,&nbsp;na:NoahsArk):&nbsp;NoahsArk&nbsp;\{...\}
14&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;def&nbsp;addPassenger(name:&nbsp;String):&nbsp;Int&nbsp;{&nbsp;...&nbsp;}
15&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;throwOverboard(name:&nbsp;String,&nbsp;why:&nbsp;String):&nbsp;Int&nbsp;{&nbsp;...&nbsp;}
16&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;def&nbsp;showPassengers()&nbsp;{&nbsp;...&nbsp;}
17&nbsp;&nbsp;&nbsp;&nbsp;
18&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;def&nbsp;main(args:&nbsp;Array[String](0)]&nbsp;{&nbsp;...&nbsp;}
19&nbsp;&nbsp;&nbsp;&nbsp;
20&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;class&nbsp;FareClasses&nbsp;{}&nbsp;&nbsp;&nbsp;
21&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;class&nbsp;Galley&nbsp;{}
&nbsp;&nbsp;&nbsp;}
</pre>
<hr />


<center>Figure 1: A class with just about everything</center>

<div class="p"><!----></div>
While the original Ark may have had two of each kind, we've settled here for one of most kinds,
and as is our custom, we work our way through the code line-by-line.  First, let's agree on some
terminology:  a <em>member</em> of a class is a piece of data, as opposed to a <em>method</em>, which
is a piece of code (a function).

<dl compact="compact">
 <dt><b></b></dt>
	<dd><b>line 1:</b>  A "<tt>static</tt>" member of a class is a constant associated with the class.
We could have said "<tt>static val DEFAULT_SIZE</tt>", but the "<tt>val</tt>" is implied.  This needn't
be a literal constant, as here, but it must be an expression that the compiler can compute.

<div class="p"><!----></div>
There are
no variable static members.  This may seem a bit harsh to Java and C++ programmers,
but there is a good reason.  X10, unlike these languages, has been intended from the start
to make full use of a multi-processor system.  By restricting the data associated with a 
class to that which is put in place at the time the class is loaded, the X10 runtime is
free to copy the loaded class from <tt>Place</tt> to <tt>Place</tt> as needed, with all of the
<tt>Place</tt>'s always then seeing a consistent view of the class.</dd>

	<dd><b>line 2:</b>  An instance member that is a <tt>val</tt> is a constant that must be computed
by the constructor for the instance.  It may be initialized as part of its declaration, but that
would be unusual.  The whole point of an <em>instance</em> <tt>val</tt> is that it is a
<em>per instance</em> constant, not a <em>per class</em> one, so the constructor would 
normally use its arguments to create the instance's value.

<div class="p"><!----></div>
We've shown this instance member as <tt>public</tt>.  As with classes, we could use nothing
here, just "<tt>val name:String</tt>", and the member could then only be used by
classes in exactly the same package (directory).
There are two other keywords available: <tt>protected</tt> and <tt>private</tt>.  A protected member
is usable by any class in the same package, and by any class that <em>extends</em> the
class in which the member is declared. See section .  A private member is
just that: usable only in the class it is declared.  Thus from most widely available to least, we have

<blockquote><tt>public</tt>, <tt>protected</tt>, <em>no spec at all</em>, <tt>private</tt></blockquote></dd>

	<dd><b>lines 3 and 4:</b> Here are two instance members that are variables.  Both are private
for good reason: <tt>onBoard</tt> is the number of valid entries in the <tt>passengers</tt> array,
and the last thing we want to do is to allow the general public complete, direct access to either.
<tt>onBoard</tt> will be updated every time we add a passenger, or throw one overboard.  
<tt>passengers</tt> will be reset when we are at capacity and want to 
add another passenger.</dd>

	<dd><b>lines 6-12:</b>  We show a couple of constructors here.  We chose to make both public,
but we need not have done so: like any other method, we can restrict the availability of 
a constructor.  We could have made one private and one protected if that is really what
we needed, unusual though that would be.

<div class="p"><!----></div>
Notice the way that the first constructor invokes the second.  It is important that this call be
the first executable line in the constructor's body.</dd>

	<dd><b>line 13:</b> This is a "static" method (or, if you prefer, a "class" method).  Static
methods have access to all of the static members and methods of the class, but 
only an instance of the class may refer to instance members methods.  This method
is in the default package, so if <tt>DieselArk</tt> is also in
that package, it can invoke <tt>resize</tt>: the syntax is <tt>NoahsArk.resize(...)</tt>.
The moral: static methods <em>really belong to the class in which they are defined.</em></dd>

	<dd><b>lines 14-16:</b> Here we have three instance methods with varying degrees of
protection.  We'll allow anyone to add a passenger, because if the boat threatens
to sink under the weight, we can always say no.  We're a little more careful about
who throw a passenger overboard: this is pretty drastic, and different kinds of
arks may have different policies.  Finally, respecting
its customers' privacy, <tt>NoahsArk</tt> reserves to itself the right to show who is on board.</dd>

	<dd><b>line 18:</b>  You've seen <tt>main</tt> enough times that all we feel we have to say
here is that you don't need one except in a class that will begin a program's execution.</dd>

	<dd><b>line 20:</b> A static class is a static <tt>val</tt> like any other, except that it names
a class.  Within the body of <tt>NoahsArk</tt>, you write "<tt>new FareClasses()</tt>"
in order to construct an instance.  From a class <em>not</em> declared within <tt>NoahsArk</tt>,
you would need  to write "<tt>new NoahsArk.FareClasses()</tt>". In this example, we opted
to give the class the default accessibility: same package can use, others not.
We could have chosen any of the other three.</dd>

	<dd><b>line 21:</b> This is an instance class, which, to be honest, is something you
are much less likely to need in X10than in  Java, because in X10you can
have instance variables whose values are functions, and you can create a function
to pass as an argument to another function without even giving it a name.  

<div class="p"><!----></div>
In any event, only an object
that is an instance of <tt>NoahsArk</tt> can refer directly to the class.  Importantly though,
the class itself may refer to instance members and methods from <tt>NoahsArk</tt>.
In our discussion of inheritance hierarchies (See "extra credit:" ),
 we'll say some more
about how classes that <tt>NoahsArk</tt> uses other than <tt>NoahsArk</tt> itself, might 
have a method call that gets passed an instance of <tt>Galley</tt>.

<div class="p"><!----></div>
The term <em>inner class</em> is synonymous with what we've called an instance class.</dd>
</dl>

<div class="p"><!----></div>
We wish we could tell you that this is all there is to a class declaration.  It isn't, but it
is more than enough to get you going.

<div class="p"><!----></div>
     <h3><a name="tth_sEc2.1">
2.1</a>&nbsp;&nbsp;Inheritance And More</h3><a name="sec:inh">
</a>

<div class="p"><!----></div>
X10supports simple (single) inheritance: all X10classes constitute a tree, in
which the root is the class <tt>x10.lang.Object</tt>, and a class <tt>Parent</tt> is the
parent of a class <tt>Child</tt> when <tt>Child</tt>'s declaration says that it extends <tt>Parent</tt>:

<blockquote><tt>class Child extends Parent { ... }</tt></blockquote>
For example:

<pre>&nbsp;public&nbsp;class&nbsp;DieselArk&nbsp;extends&nbsp;NoahsArk&nbsp;{
&nbsp;&nbsp;&nbsp;public&nbsp;val&nbsp;fuelTankCapacity:&nbsp;Double;&nbsp;//&nbsp;in&nbsp;gallons
&nbsp;&nbsp;&nbsp;public&nbsp;var&nbsp;gallonsRemaining:&nbsp;Double;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;public&nbsp;def&nbsp;this(name:String;&nbsp;maxPsgrs:Int,&nbsp;tankSIze:Double)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(name,&nbsp;maxPsgrs);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fuelTankCapacity&nbsp;=&nbsp;gallonsRemaining&nbsp;=&nbsp;tankSIze;
&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;def&nbsp;throwOverboard(name:&nbsp;String,&nbsp;why:&nbsp;String):&nbsp;Int&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(name,&nbsp;why);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;more&nbsp;stuff&nbsp;here&nbsp;*/
&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;/*&nbsp;...&nbsp;more&nbsp;methods&nbsp;here&nbsp;*/
&nbsp;}
</pre>
 A <tt>DieselArk</tt> is a <tt>NoahsArk</tt> whose method of propulsion we know.  It is that sense
 that <tt>DieselArk</tt> is an extension <tt>NoahsArk</tt>: it is a <tt>NoahsArk</tt> and more.  The use
 of "extension"  is a bit strange: it is easier to be just a <tt>NoahsArk</tt>.  One also says that
"<tt>DieselArk</tt> <em>is a direct subclass of</em> <tt>NoahsArk</tt>", which seems (to the authors, at any
 rate) to be more appealing.
 
<blockquote>
 More generally, a class <tt>S</tt> is a <em>subclass</em> of another class <tt>C</tt> if there is a chain of classes
 <tt>S</tt>, <tt>S1</tt>, ..., <tt>Sn</tt>, <tt>C</tt> in which each is a <em>direct</em> subclass of the next.
</blockquote>
In declarations in which no <tt>extends</tt>
clause appears, like those for the classes <tt>MontePi</tt> or <tt>HelloWorld</tt>, 
the class extends <tt>x10.lang.Object</tt> by default.

<div class="p"><!----></div>
An instance of <tt>DieselArk</tt> will have instance members <tt>name</tt>, <tt>passengers</tt>,
and <tt>onBoard</tt>, and methods <tt>resize</tt>, <tt>addPassenger</tt>, and so on, which are said to
be <em>inherited from <tt>NoahsArk</tt></em>.
Notice that <tt>DieselArk</tt> provides its own version of the method <tt>throwOverboard</tt>, 
so rather than inheriting that method, it <em>overrides it</em>.  The expression <tt>super(name,why)</tt>
in the body of the override invokes the parent's version of <tt>throwOverboard</tt>.

<blockquote>
Be careful! While every instance of <tt>DieselArk</tt> inherits the private members
of <tt>NoahsArk</tt>, <em>only the methods already in <tt>NoahsArk</tt> have access to them.</em>
Thus, <tt>DieselArk</tt> can affect the array <tt>passengers</tt> only by invoking methods
like <tt>addPassenger</tt> that it inherits from <tt>NoahsArk</tt>.
</blockquote>
Subclasses are free to override any of the methods they inherit.

<div class="p"><!----></div>
If a method <tt>m</tt> expects an argument that is an instance of a class <tt>C</tt>,
and if <tt>D</tt> is a subclass of <tt>C</tt>, then it is okay to call <tt>m</tt> with an
instance of <tt>D</tt>.
Suppose, for example, we have a class <tt>CruiseLine</tt> whose instances have fleets of ships
that sail the world with lots of passengers.  A <tt>CruiseLine</tt> instance
might want to add a <tt>NoahsArk</tt> to its fleet, so it has a method

<pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;def&nbsp;addShip(ark:&nbsp;NoahsArk)&nbsp;{&nbsp;...&nbsp;}
</pre>
Because a <tt>DieselArk</tt> <em>is</em> a <tt>NoahsArk</tt>, we can call <tt>addShip</tt>
with a <tt>DieselArk</tt> as the argument.

<div class="p"><!----></div>
A similar rule holds for return values.  If a method is supposed to return a 
<tt>NoahsArk</tt>, it can return one that just happens also to be <tt>DieselArk</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc2.1.1">
2.1.1</a>&nbsp;&nbsp;Extra credit:</h4><a name="ssec:pinc">
</a>
This gets us to the point where we can answer a question we raised in a previous
section, which is "how can one class's methods get passed arguments that are
instances of another class's inner class?"  Again, the honest truth is that occasions
for using inner classes in X10 are pretty rare, so feel free to skip this on first
reading.   

<div class="p"><!----></div>
Subclassing is the key for giving a visible name to an otherwise invisible class:   

<ul>
<li> Suppose
there is a public class <tt>Kitchen</tt>, and suppose that in our declaration of <tt>NoahsArk</tt>
we had written "<tt>protected class Galley extends Kitchen { ... }</tt>" .
<div class="p"><!----></div>
</li>

<li> Let's add to <tt>NoahsArk</tt>  a private member 
"<tt>var galley:Galley</tt>" and a public method <tt>getGalley()</tt> that returns <tt>galley</tt>.
<div class="p"><!----></div>
</li>

<li> If a  class has a method whose signature is "<tt>isWellEquipped(k: Kitchen)</tt>",
and if <tt>anArk</tt> is a <tt>NoahsArk</tt>, then the call

<pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isWellEquipped(anArk.getGalley())
</pre>
is perfectly okay, because a <tt>Galley</tt>, wherever it came from, is a <tt>Kitchen</tt>.
<div class="p"><!----></div>
</li>
</ul>

<div class="p"><!----></div>
     <h3><a name="tth_sEc2.2">
2.2</a>&nbsp;&nbsp;Concrete classes versus wishful thinking</h3>
Our declaration of <tt>NoahsArk</tt> is an example of wishful thinking, because
if you are the least bit realistic about it, an ark without any means of propulsion isn't a very
useful sort of thing, at least if you want to go anywhere in it.  On the other hand, there
are a large number of very different propulsion systems:  we've got <tt>DieselArk</tt>
already, and <tt>SteamArk</tt>, <tt>SailArk</tt>, and <tt>RowedArk</tt> are also good possibilities.

<div class="p"><!----></div>
So, <tt>NoahsArk</tt>, lacking, as it does, any means of getting anywhere, is, in a very clear sense,
not a <em>concrete</em> class: you will never see an instance that is not actually an instance
of some subclass.  Folks just don't build boats that go nowhere.

<div class="p"><!----></div>
But that is not to say that <tt>NoahsArk</tt> can't capture a lot of concrete 
information-passenger lists, fare schedules, itinerary, and so on-that
all arks share, no matter their means of propulsion.  That makes <tt>NoahsArk</tt> a good example of what is 
called an <em>abstract</em> class: a class that one does not intend to instantiate, but
which is the ultimate parent of a set of classes that one does.

<div class="p"><!----></div>
To convert <tt>NoahsArk</tt> to being an abstract class, one just adds the keyword
"<tt>abstract</tt>" to its declaration:

<pre>&nbsp;public&nbsp;abstract&nbsp;class&nbsp;NoahsArk&nbsp;{&nbsp;...&nbsp;}
</pre>
An abstract class is permitted to declare method signatures that it itself does not
implement, but that any of its subclasses that
are not themselves abstract <em>must</em> implement.  Here is an example:

<pre>public&nbsp;abstract&nbsp;def&nbsp;costPerPassengerMile():&nbsp;Double;
</pre>
Notice that there is no function body: there is just a trailing semicolon.
If we want to be allowed to execute "<tt>new DieselArk( ... );</tt>", that class will have to implement this
method.  In <tt>DieselArk</tt>, the declaration will look like:

<pre>public&nbsp;def&nbsp;costPerPassengerMile():&nbsp;Double&nbsp;{&nbsp;...&nbsp;}
</pre>
The keyword <tt>abstract</tt> does <em>not</em> appear, and the function body does.
<hr /><h3>Footnotes:</h3>

<div class="p"><!----></div>
<a name="tthFtNtAAB"></a><a href="#tthFrefAAB"><sup>1</sup></a>This should explain
why, even though a package spec is a proxy for a file system path, dots and not
slashes are used to punctuate it: first, the dot is file-system independent, and
second, it is consistent with the notation for selecting a field within an object.
<br /><br />

</html>