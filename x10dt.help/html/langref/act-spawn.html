<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>async: Spawning an Activity</title>
</head>

<body>
 <h2><a name="tth_sEc3">
3</a>&nbsp;&nbsp;<b>async</b>: Spawning an activity</h2><a name="AsynchronousActivity">
</a><a name="AsyncActivity">
</a>

<div class="p"><!----></div>
Asynchronous activities serve as a single abstraction for supporting a
wide range of concurrency constructs such as message passing, threads,
DMA, streaming, data prefetching. (In general, asynchronous operations
are better suited for supporting scalability than synchronous
operations.)

<div class="p"><!----></div>
An activity is created by executing the <b>async</b> statement: 

<div class="p"><!----></div>
  :  |        <em>  
<table>
<tr><td align="right">Statement ::= AsyncStatement </td></tr>
<tr><td align="right">AsyncStatement ::= <b>async</b> PlaceExpressionSingleList<sup>?</sup>&nbsp;Statement </td></tr>
<tr><td align="right">PlaceExpressionSingleList ::= <b>(</b> PlaceExpression <b>)</b> </td></tr>
<tr><td align="right">PlaceExpression ::= Expression 
</td></tr></table>
</em> 

<div class="p"><!----></div>
The basic form of <b>async</b> is <b>async S</b>, which starts a new activity
located <b>here</b> executing <b>S</b>.    The form 
<b>async (p) S</b> is simply shorthand for <b>async at(p) S</b>, covering the
common case where the activity is to be executed at some other place. 

<div class="p"><!----></div>
Note that the array subscript expression <b>a(i)</b>, when used as a place
expression evaluates to <b>a(i).home</b>, . the home of the contents of
<b>a(i)</b> In general, this is not the same place that the array cell itself
is, . <b>a.dist(i)</b>. Accesses to <b>a(i)</b> should typically be guarded
by the place expression <b>a.dist(i)</b>: 
<pre>
async (a.dist(i)) {
  a(i) += 1;
}
</pre>

<div class="p"><!----></div>
In many cases the compiler may infer the unique place at which the
statement is to be executed by an analysis of the types of the
variables occurring in the statement. (The place must be such that the
statement can be executed safely, without generating a
<b>BadPlaceException</b>.) In such cases the programmer may omit the
place designator; the compiler will throw an error if it cannot
determine the unique designated place.<a href="#tthFtNtAAD" name="tthFrefAAD"><sup>3</sup></a>

<div class="p"><!----></div>
An activity A executes the statement <b>async (P) S</b> by launching
a new activity B at place <b>P</b> (or <b>P.home</b> if <b>P</b> is of an
object type), to execute <b>S</b>. The statement terminates locally as soon as B is
launched.  The activation path for B is that of A augmented by the
information that A is the parent of B. 
B
terminates normally when S terminates normally.  It terminates
abruptly if S throws an uncaught exception. The exception is
propagated to A if A is a root activity (see &#167;),
otherwise it is propagated through A to A's root activity. Note that while
A is running, exceptions thrown by activities it has already
spawned may propagate through it up to its root activity, without A noticing.

<div class="p"><!----></div>
Multiple activities launched by a single activity at another place are not
ordered in any way. They are added to the set of activities at the target
place and will be executed based on the local scheduler's decisions.
If some particular sequencing of events is needed, <b>when</b>, <b>atomic</b>,
<b>await</b>, <b>finish</b>, clocks, and other X10 constructs can be used.
X10 implementations are not required to have fair schedulers,
though every implementation should make a best faith effort to ensure
that every activity eventually gets a chance to make forward progress.

<div class="p"><!----></div>
 S<font size="-2">TATIC</font> S<font size="-2">EMANTICS</font> R<font size="-2">ULE</font>:
The statement in the body of an <b>async</b> is subject to the
restriction that it must be acceptable as the body of a <b>void</b>
method for an anonymous inner class declared at that point in the code,
which throws no checked exceptions. As such, it may reference
variables in lexically enclosing scopes (including <b>clock</b>
variables, &#167;) provided that such variables are
(implicitly or explicitly) <b>val</b>.


<div class="p"><!----></div>

</body>
</html>