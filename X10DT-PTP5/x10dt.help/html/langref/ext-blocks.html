<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>Native Blocks</title>
</head>

<body>
 <h2><a name="tth_sEc2">
2</a>&nbsp;&nbsp;Native Blocks</h2>

<div class="p"><!----></div>
Any block may be annotated with <b>@Native(lang,stmt)</b>, indicating that, in
the given back end, it should be implemented as <b>stmt</b>. All value
variables from the surrounding context are available inside <b>stmt</b>. For
example, the method call <b>born.example(10)</b>, if compiled to Java, changes
the field <b>y</b> of a <b>Born</b> object to 10. If compiled to C++ (for which
there is no <b>@Native</b>), it sets it to 3. 
<pre>
import x10.compiler.Native;
class Born {
  var y : Int = 1; 
  public def example(x:Int):Int{
    @Native("java", &#255;=x;") 
    {y = 3;}
    return y;
  }
}
</pre>

<div class="p"><!----></div>
Note that the code being replaced is a statement - the block <b>y = 3;</b>
in this case - so the replacement should also be a statement. 

<div class="p"><!----></div>
Other X10 constructs may or may not be available in Java and/or C++ code.  For
example, type variables do not correspond exactly to type variables in either
language, and may not be available there.  The exact compilation scheme is
<em>not</em> fully specified.  You may inspect the generated Java or C++ code and
see how to do specific things, but there is no guarantee that fancy extern
coding will continue to work in later versions of X10.

<div class="p"><!----></div>
The full facilities of C++ or Java are available in native code blocks.
However, there is no guarantee that advanced features behave sensibly. You
must follow the exact conventions that the code generator does, or you will
get unpredictable results.  Furthermore, the code generator's conventions may
change without notice or documentation from version to version.  In most cases
the  code should either be a very simple expression, or a method
or function call to external code.

<div class="p"><!----></div>

</body>
</html>