<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>Iteration</title>
</head>

<body>
 <h2><a name="tth_sEc7">
7</a>&nbsp;&nbsp;Iteration</h2><a name="ForLoop">
</a>
<a name="ForAllLoop">
</a>

<div class="p"><!----></div>
We introduce  k-dimensional versions of iteration operations <tt>for</tt> and 
<tt>foreach</tt>:

<div class="p"><!----></div>
<pre>
189 Statement ::= ForStatement
206 StatementNoShortIf ::= 
      ForStatementNoShortIf
236 ForStatement ::= EnhancedForStatement
239 ForStatementNoShortIf ::= 
      EnhancedForStatementNoShortIf
466 Statement ::= ForEachStatement
476 StatementNoShortIf ::= 
      ForEachStatementNoShortIf
487 EnhancedForStatement ::= 
       for ( FormalParameter : Expression ) 
         Statement
487 EnhancedForStatementNoShortIf ::= 
       for ( FormalParameter : Expression ) 
           StatementNoShortIf
485  ForEachStatement ::= 
       foreach ( FormalParameter : Expression ) 
           Statement
495  ForEachStatementNoShortIf ::= 
        foreach ( FormalParameter : Expression ) 
          StatementNoShortIf
</pre>

<div class="p"><!----></div>
In both statements, the expression is intended to be of type <tt>
region</tt>.  Expressions <tt>e</tt> of type <tt>distribution</tt> and <tt>
array</tt> are also accepted, and treated as if they were <tt>
e.region</tt>. The compiler throws a type error in all other cases.

<div class="p"><!----></div>
The formal parameter must be of type <tt>point</tt>. Exploded syntax may
be used (&#167;&nbsp;12.3). The parameter is considered
implicitly final, as are all the exploded variables. 

<div class="p"><!----></div>
An activity executes a <tt>for</tt> statement by enumerating the points
in the region in canonical order. The activity executes the body of
the loop with the formal parameter(s) bound to the given point. If the
body locally terminates successfully, the activity continues with the
next iteration, terminating successfully when all points have been
visited. If an iteration throws an exception then the for statement
throws an exception and terminats abruptly.

<div class="p"><!----></div>
An activity executes a <tt>foreach</tt> statement in a similar fashion
except that separate <tt>async</tt> activities are launched in parallel
in the local place for each point in the region. The statement
terminates locally when all the activities have been spawned. It never
throws an exception, though exceptions thrown by the spawned
activities are propagated through to the root activity.

<div class="p"><!----></div>
In a similar fashion we introduce the syntax:
<pre>
467 Statement ::= AtEachStatement
477 StatementNoShortIf ::= 
      AtEachStatementNoShortIf
486 AtEachStatement ::= 
      ateach ( FormalParameter : Expression ) 
         Statement
496 AtEachStatementNoShortIf ::= 
      ateach ( FormalParameter : Expression ) 
          StatementNoShortIf
</pre>

<div class="p"><!----></div>
Here the expression is intended to be of type <tt>distribution</tt>.
Expressions <tt>e</tt> of type <tt>array</tt> are also accepted, and treated
as if they were <tt>e.distribution</tt>. The compiler throws a type error
in all other cases. This statement differs from <tt>foreach</tt> only in
that each activity is spawned at the place specified by the
distribution for the point. That is, 
<tt>ateach( point p[i1,...,ik]: A) S</tt> may
be thought of as standing for:
<pre>
  foreach (point p[i1,...,ik] : A) 
    async (A.distribution[p]) {S}
</pre>

<div class="p"><!----></div>
<hr /><h3>Footnotes:</h3>

<div class="p"><!----></div>
<a name="tthFtNtAAB"></a><a href="#tthFrefAAB"><sup>1</sup></a>Note that depending on the state of the computation
the activation path may traverse activities that are running,
suspended or terminated.
<div class="p"><!----></div>
<a name="tthFtNtAAC"></a><a href="#tthFrefAAC"><sup>2</sup></a>In   X10 v1.01 the <tt>finish</tt>
statement is the only statement that marks its activity as a root
activity. Future versions of the language may introduce more such
statements.
<div class="p"><!----></div>
<a name="tthFtNtAAD"></a><a href="#tthFrefAAD"><sup>3</sup></a>  X10 v1.01 does 
not specify a particular algorithm; this will be fixed in future versions.
<div class="p"><!----></div>
<a name="tthFtNtAAE"></a><a href="#tthFrefAAE"><sup>4</sup></a> A static bound is a constant
that depends only on the program text, and is independent 
of any runtime parameters. 
<br /><br /><hr /><small>File translated from
T<sub><font size="-1">E</font></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><font size="-1">T</font></sub>H</a>,
version 3.80.<br />On 07 Jun 2008, 13:48.</small>
</body>
</html>