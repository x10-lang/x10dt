<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>Example</title>
</head>

<body>
This example illustrates 2-d Jacobi iteration.

<div class="p"><!----></div>
<pre>
public class Jacobi {
   const N: int = 6;
   const epsilon: double = 0.002;
   const epsilon2: double = 0.000000001;
   const R: region = [0:N+1, 0:N+1];
   const RInner: region = [1:N, 1:N];
   const D: distribution = distribution.factory.block(R);
   const DInner: distribution = D  -  RInner;
   const DBoundary: distribution = D - RInner;
   const EXPECTED_ITERS: int  = 97;
   const double EXPECTED_ERR: double = 0.0018673382039402497;

<div class="p"><!----></div>
   val B: Array[double](D) = Array.make[double](D,
        (p(i,j): point) =&#62; DBoundary.contains(p) ? (N-1)/2 : N*(i-1)+(j-1));

<div class="p"><!----></div>
   public def run(): boolean {
      var iters: int = 0;
      var err: double;
      while (true) {
        val Temp: Array[double] = 
           new array[double](DInner, ((i,j): point) =&#62;
             (read(i+1,j)+read(i-1,j) +read(i,j+1)+read(i,j-1))/4.0);
        if((err=((B  -  DInner) - Temp).abs().sum()) &lt; epsilon)
           break; 
        B.update(Temp);
        iters++; 
      }
      Console.OUT.println("Error="+err);
      Console.OUT.println("Iterations="+iters);
      return Math.abs(err-EXPECTED_ERR)&lt;epsilon2 
          && iters==EXPECTED_ITERS;
   }
   public def read(i: int, j: int): double {
      return (future(D(i,j)) =&#62; B(i,j)).force();
   }
   public static def main(args: Array[String]) { 
      val b = new Jacobi().run();
      Console.OUT.println("++++++ "
                          + (b? "Test succeeded."
                             :"Test failed."));
      System.exit(b?0:1);
   }
}
</pre>

</body>
</html>