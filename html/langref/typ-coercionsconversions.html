<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
<title>Coercions and conversions</title>
</head>

<body>
 <h2><a name="tth_sEc9">
9</a>&nbsp;&nbsp;Coercions and conversions</h2>
<a name="XtenConversions">
</a>
<a name="User-definedCoercions">
</a>


<div class="p"><!----></div>
X10 v2.0 supports the following coercions and conversions

<div class="p"><!----></div>
     <h3><a name="tth_sEc9.1">
9.1</a>&nbsp;&nbsp;Coercions</h3>

<div class="p"><!----></div>
A <em>coercion</em> does not change object identity; a coerced object may
be explicitly coerced back to its original type through a cast. A <em>
  conversion</em> may change object identity if the type being converted
to is not the same as the type converted from. X10 permits
user-defined conversions (&#167;).

<div class="p"><!----></div>

<b>Subsumption coercion.&nbsp;&nbsp;</b>
A subtype may be implicitly coerced to any supertype.


<div class="p"><!----></div>

<b>Explicit coercion (casting with &#228;s")&nbsp;&nbsp;</b>
A reference type may be explicitly coerced to any other
reference type using the &#228;s" operation.
If the value coerced is not an instance of the target type,
a "ClassCastException" is thrown.  Casting to a constrained
type may require a run-time check that the constraint is
satisfied.




<div class="p"><!----></div>
     <h3><a name="tth_sEc9.2">
9.2</a>&nbsp;&nbsp;Conversions</h3>

<div class="p"><!----></div>

<b>Narrowing conversion.&nbsp;&nbsp;</b>
A value class may be explicitly converted to any superclass
using the &#228;s" operation.

<div class="p"><!----></div>

<b>Widening numeric conversion.&nbsp;&nbsp;</b>
A numeric type may be implicitly converted to a wider numeric type. In
particular, an implicit conversion may be performed between a numeric
type and a type to its right, below:

<div class="p"><!----></div>
<pre>
Byte &lt; Short &lt; Int &lt; Long &lt; Float &lt; Double
</pre>

<div class="p"><!----></div>

<b>String conversion.&nbsp;&nbsp;</b>
Any object that is an operand of the binary
"+" operator may
be converted to "String" if the other operand is a "String".
A conversion to "String" is performed by invoking the "toString()"
method of the object.

<div class="p"><!----></div>

<b>User defined conversions.&nbsp;&nbsp;</b><a name="sec:user-defined-conversions">
</a>


<div class="p"><!----></div>
The user may define conversion operators from type &#196;" <em>to</em> a
container type "B" by specifying a method on "B" as follows:

<div class="p"><!----></div>
<pre>
  public static operator (r: A): T = ... 
</pre>

<div class="p"><!----></div>
The return type "T" should be a subtype of "B". The return
type need not be specified explicitly; it will be computed in the
usual fashion if it is not. However, it is good practice for the
programmer to specify the return type for such operators explicitly.

<div class="p"><!----></div>
For instance, the code for "x10.lang.Point" contains:

<div class="p"><!----></div>
<pre>
  public static global safe operator (r: Rail[int])
     : Point(r.length) = make(r);
</pre>

<div class="p"><!----></div>
The compiler looks for such operators on the container type "B"
when it encounters an expression of the form "r as B" (where
"r" is of type &#196;"). If it finds such a method, it sets the
type of the expression "r as B" to be the return type of the
method. Thus the type of "r as B" is guaranteed to be some subtype
of "B".

<div class="p"><!----></div>
Consider the following code:  
<pre>
val p  = [2, 2, 2, 2, 2] as Point;
val q = [1, 1, 1, 1, 1] as Point;
val a = p - q;    
</pre>
This code fragment compiles successfully, given the above operator definition. 
The type of "p" is inferred to be "Point(5)" (i.e.{} the type 
"Point{self.rank==5}".
Similarly for "q". Hence the application of the operator ""-''' is legal (it requires both arguments to have the same rank). The type of &#228;" is computed as "Point(5)".



<div class="p"><!----></div>

<div class="p"><!----></div>

</body>
</html>